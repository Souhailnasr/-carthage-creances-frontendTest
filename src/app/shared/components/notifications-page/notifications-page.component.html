<div class="notifications-container">
  <div class="header">
    <h1>Mes Notifications</h1>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="markAllAsRead()" [disabled]="getUnreadCount() === 0">
        <i class="fas fa-check-double"></i>
        Marquer tout comme lu
      </button>
      <a routerLink="/send-notification" class="btn btn-secondary">
        <i class="fas fa-paper-plane"></i>
        Envoyer une notification
      </a>
    </div>
  </div>

  <!-- Filtres -->
  <div class="filters-section">
    <div class="filter-group">
      <label for="statusFilter">Statut :</label>
      <select id="statusFilter" [(ngModel)]="selectedFilter" (change)="onFilterChange()">
        <option value="all">Toutes</option>
        <option value="unread">Non lues</option>
        <option value="read">Lues</option>
      </select>
    </div>
    
    <div class="filter-group">
      <label for="typeFilter">Type :</label>
      <select id="typeFilter" [(ngModel)]="selectedType" (change)="onTypeChange()">
        <option *ngFor="let option of getTypeOptions()" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>
  </div>

  <!-- Statistiques -->
  <div class="stats-section">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-bell"></i>
      </div>
      <div class="stat-content">
        <h3>{{ notifications.length }}</h3>
        <p>Total</p>
      </div>
    </div>
    
    <div class="stat-card unread">
      <div class="stat-icon">
        <i class="fas fa-exclamation-circle"></i>
      </div>
      <div class="stat-content">
        <h3>{{ getUnreadCount() }}</h3>
        <p>Non lues</p>
      </div>
    </div>
    
    <div class="stat-card read">
      <div class="stat-icon">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-content">
        <h3>{{ notifications.length - getUnreadCount() }}</h3>
        <p>Lues</p>
      </div>
    </div>
  </div>

  <!-- Liste des notifications -->
  <div class="notifications-list" *ngIf="!isLoading; else loadingTemplate">
    <div class="notification-item" 
         *ngFor="let notification of filteredNotifications" 
         [class.unread]="notification.statut === 'NON_LUE'"
         [class.read]="notification.statut === 'LUE'">
      
      <div class="notification-icon" [ngClass]="getNotificationClass(notification.type)">
        <i [class]="getNotificationIcon(notification.type)"></i>
      </div>
      
      <div class="notification-content">
        <div class="notification-header">
          <h3>{{ notification.titre }}</h3>
          <span class="notification-time">{{ formatDate(notification.dateCreation) }}</span>
        </div>
        
        <p class="notification-message">{{ notification.message }}</p>
        
        <div class="notification-meta">
          <span class="notification-type">{{ notification.type }}</span>
          <span class="notification-status" 
                [class.status-unread]="notification.statut === 'NON_LUE'"
                [class.status-read]="notification.statut === 'LUE'">
            {{ notification.statut === 'NON_LUE' ? 'Non lue' : 'Lue' }}
          </span>
        </div>
      </div>
      
      <div class="notification-actions">
        <button class="btn-action" 
                *ngIf="notification.statut === 'NON_LUE'"
                (click)="markAsRead(notification)"
                title="Marquer comme lu">
          <i class="fas fa-check"></i>
        </button>
        
        <button class="btn-action delete" 
                (click)="deleteNotification(notification)"
                title="Supprimer">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    </div>
    
    <div class="no-notifications" *ngIf="filteredNotifications.length === 0">
      <i class="fas fa-bell-slash"></i>
      <h3>Aucune notification trouvée</h3>
      <p>Aucune notification ne correspond à vos critères de filtrage.</p>
    </div>
  </div>

  <ng-template #loadingTemplate>
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Chargement des notifications...</p>
    </div>
  </ng-template>
</div>
