<div class="dossiers-en-attente-container">
  <div class="header">
    <h1><mat-icon>pending_actions</mat-icon> Dossiers en Attente de Validation</h1>
    <p class="subtitle">Gérez les dossiers créés par les agents en attente de validation</p>
  </div>

  <div class="loading-container" *ngIf="loading">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Chargement en cours...</p>
  </div>

  <div class="table-container" *ngIf="!loading">
    <table mat-table [dataSource]="dataSource" class="dossiers-table">
      <!-- Numéro Dossier Column -->
      <ng-container matColumnDef="numeroDossier">
        <th mat-header-cell *matHeaderCellDef>Numéro Dossier</th>
        <td mat-cell *matCellDef="let validation">{{ validation.dossier.numeroDossier }}</td>
      </ng-container>

      <!-- Titre Column -->
      <ng-container matColumnDef="titre">
        <th mat-header-cell *matHeaderCellDef>Titre</th>
        <td mat-cell *matCellDef="let validation">{{ validation.dossier.titre }}</td>
      </ng-container>

      <!-- Agent Créateur Column -->
      <ng-container matColumnDef="agentCreateur">
        <th mat-header-cell *matHeaderCellDef>Agent Créateur</th>
        <td mat-cell *matCellDef="let validation">{{ getAgentName(validation) }}</td>
      </ng-container>

      <!-- Date Création Column -->
      <ng-container matColumnDef="dateCreation">
        <th mat-header-cell *matHeaderCellDef>Date Création</th>
        <td mat-cell *matCellDef="let validation">{{ formatDate(validation.dateCreation) }}</td>
      </ng-container>

      <!-- Statut Column -->
      <ng-container matColumnDef="statut">
        <th mat-header-cell *matHeaderCellDef>Statut</th>
        <td mat-cell *matCellDef="let validation">
          <span class="statut-badge" [ngClass]="getStatutClass(validation.statut)">
            {{ validation.statut }}
          </span>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let validation" class="actions-cell">
          <button mat-icon-button 
                  color="primary" 
                  (click)="voirDetails(validation)"
                  title="Voir détails">
            <mat-icon>visibility</mat-icon>
          </button>
          <button mat-raised-button 
                  color="primary" 
                  (click)="validerDossier(validation)"
                  [disabled]="loading"
                  title="Valider le dossier">
            <mat-icon>check_circle</mat-icon>
            Valider
          </button>
          <button mat-raised-button 
                  color="warn" 
                  (click)="rejeterDossier(validation)"
                  [disabled]="loading"
                  title="Rejeter le dossier">
            <mat-icon>cancel</mat-icon>
            Rejeter
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <!-- No data row -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" [attr.colspan]="displayedColumns.length">
          <div class="no-data">
            <mat-icon>info</mat-icon>
            <p>Aucun dossier en attente de validation</p>
          </div>
        </td>
      </tr>
    </table>
  </div>
</div>

